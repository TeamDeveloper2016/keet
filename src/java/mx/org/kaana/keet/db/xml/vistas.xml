<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
		Relación de consultas para las vistas de MANTIC
-->
<process>
	<dml> 
		<unit id="VistaTiposObrasDto">
			<select id="catalogo">
				select
					tc_keet_tipos_obras.id_tipo_obra AS id_key,
					tc_keet_tipos_obras.id_division,
					tc_keet_tipos_obras.clave,
					tc_keet_tipos_obras.nombre tipo_obra,
					tc_keet_divisiones.nombre tipo_division
				from
					tc_keet_tipos_obras
				inner join
					tc_keet_divisiones ON tc_keet_tipos_obras.id_division = tc_keet_divisiones.id_division
				order by
					tc_keet_tipos_obras.id_division, tc_keet_tipos_obras.clave
			</select>			
		</unit>
    <unit id="VistaContratosDto">
			<select id="lazy">
				select
          tc_keet_clientes_contratos.id_cliente_contrato as id_key,
          tc_keet_clientes_contratos.clave,
          tc_keet_clientes_contratos.nombre,
          tc_keet_clientes_contratos.recepcion,
          tc_keet_clientes_contratos.aceptacion,
          tc_mantic_clientes.razon_social cliente,
          tc_mantic_empresas.nombre empresa,
          concat(tc_mantic_domicilios.calle, ", ",tc_mantic_domicilios.numero_exterior) domicilio
        from
          tc_keet_clientes_contratos
        inner join tc_mantic_clientes on tc_mantic_clientes.id_cliente= tc_keet_clientes_contratos.id_cliente
        inner join tc_mantic_empresas on tc_mantic_empresas.id_empresa= tc_keet_clientes_contratos.id_empresa
        inner join tc_mantic_domicilios on tc_mantic_domicilios.id_domicilio= tc_keet_clientes_contratos.id_empresa
        inner join tc_janal_usuarios on tc_janal_usuarios.id_usuario= tc_keet_clientes_contratos.id_usuario
        where
          tc_mantic_empresas.id_empresa in ({sucursales})
        and 
          {condicion}
				order by
					tc_keet_clientes_contratos.id_cliente_contrato
			</select>	
		</unit>
    <unit id="VistaPrototiposDto">
			<select id="lazy">
				select 
          tc_keet_prototipos.id_prototipo as id_key,
          tc_keet_prototipos.clave,
          tc_keet_prototipos.nombre,
          tc_keet_prototipos.descripcion,
          tc_keet_prototipos.metros2,
          tc_mantic_clientes.razon_social
        from
          tc_keet_prototipos
        inner join tc_mantic_clientes on tc_mantic_clientes.id_cliente= tc_keet_prototipos.id_cliente
        where
          {condicion}
				  {sortOrder}
			</select>	
			<select id="constructivosById">
				select      
					tc_keet_prototipos_constructivos.id_prototipo_constructivo id_key,
					tc_keet_prototipos_constructivos.*,
					tc_keet_constructivos.nombre descripcion,
					tc_keet_grupos_constructivos.nombre grupo
				from   
				tc_keet_prototipos_constructivos
				inner join tc_keet_constructivos on tc_keet_prototipos_constructivos.id_constructivo= tc_keet_constructivos.id_constructivo
				inner join tc_keet_grupos_constructivos on tc_keet_constructivos.id_grupo_constructivo= tc_keet_grupos_constructivos.id_grupo_constructivo
				where
          tc_keet_prototipos_constructivos.id_prototipo= {idPrototipo}
			</select>	
			<select id="constructivosSelect">
				select      
					tc_keet_constructivos.id_constructivo id_key,
					tc_keet_constructivos.nombre descripcion,
					tc_keet_grupos_constructivos.nombre grupo
				from   
				tc_keet_constructivos 
				inner join tc_keet_grupos_constructivos on tc_keet_constructivos.id_grupo_constructivo= tc_keet_grupos_constructivos.id_grupo_constructivo
				where
          {condicion}
				order by
				  tc_keet_grupos_constructivos.nombre, tc_keet_constructivos.nombre
			</select>
		  <select id="getPlanosEspecialidades">
				select 
					tc_keet_planos.id_plano id_key,
					tc_keet_planos.nombre descripcion,
					tc_keet_especialidades.nombre grupo 
				from
					tc_keet_planos
				inner join tc_keet_especialidades on tc_keet_planos.id_especialidad= tc_keet_especialidades.id_especialidad
        where
          {condicion}
				order by
					tc_keet_especialidades.nombre, tc_keet_planos.nombre
			</select>		
		  <select id="getImportados">
				select
					id_prototipo_archivo id_key,
					tc_keet_prototipos_archivos.nombre,
					tc_keet_prototipos_archivos.archivo,
					tc_keet_prototipos_archivos.ruta,
					tc_keet_prototipos_archivos.alias,
					tc_keet_prototipos_archivos.observaciones,
					tc_keet_prototipos_archivos.registro,
					concat(tc_mantic_personas.nombres,' ',tc_mantic_personas.paterno,' ',tc_mantic_personas.materno) usuario,
					tc_keet_prototipos_archivos.id_tipo_archivo
				from
					tc_keet_prototipos_archivos
				inner join 
					tc_janal_usuarios on tc_keet_prototipos_archivos.id_usuarios= tc_janal_usuarios.id_usuario
				inner join 
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				where
				  id_prototipo= {idPrototipo}
			</select>		
		</unit>
    <unit id="VistaProyectoDto">
			<select id="lazy">
				select 
          tc_keet_proyectos.id_proyecto id_key,
          tc_keet_proyectos.clave,
          tc_keet_proyectos.no_viviendas,
          tc_keet_proyectos.etapa,
          tc_mantic_clientes.razon_social,
          tc_keet_desarrollos.nombres desarrollo,
          tc_keet_tipos_obras.nombre tipo_obra,
					tc_keet_proyectos.registro
        from 
          tc_keet_proyectos
        inner join 
					tc_mantic_clientes on tc_mantic_clientes.id_cliente= tc_keet_proyectos.id_cliente
        inner join 
					tc_keet_desarrollos on tc_keet_desarrollos.id_desarrollo= tc_keet_proyectos.id_desarrollo
        inner join 
					tc_keet_tipos_obras on tc_keet_tipos_obras.id_tipo_obra= tc_keet_proyectos.id_tipos_obras
        where
          {condicion}
				{sortOrder}
			</select>	
			<select id="tiposObraPorDivision">
				select 
					tc_keet_tipos_obras.id_tipo_obra id_key,
					tc_keet_tipos_obras.nombre descripcion,
					tc_keet_divisiones.nombre grupo
				from tc_keet_tipos_obras
				inner join tc_keet_divisiones on tc_keet_tipos_obras.id_division= tc_keet_divisiones.id_division
				order by
				  tc_keet_divisiones.nombre, tc_keet_tipos_obras.nombre
			</select>	
		</unit>	
		<unit id="VistaProyectosArchivosDto">
			<select id="importados">
				select
					tc_keet_proyectos_archivos.id_proyecto_archivo id_key,
					tc_keet_proyectos_archivos.nombre,
					tc_keet_proyectos_archivos.archivo,
					tc_keet_proyectos_archivos.ruta,
					tc_keet_proyectos_archivos.alias,
					tc_keet_proyectos_archivos.observaciones,
					tc_keet_proyectos_archivos.registro,
					concat(tc_mantic_personas.nombres,' ',tc_mantic_personas.paterno,' ',tc_mantic_personas.materno) usuario,
					tc_keet_proyectos_archivos.id_tipo_archivo,
					tc_keet_prototipos.clave clave_prototipo,
					tc_keet_prototipos.nombre nombre_prototipo,
					tc_keet_especialidades.clave clave_especialidad,
					tc_keet_especialidades.nombre nombre_especialidad,
					tc_keet_planos.nombre nombre_plano
				from
					tc_keet_proyectos_archivos
				inner join 
					tc_janal_usuarios on tc_keet_proyectos_archivos.id_usuario = tc_janal_usuarios.id_usuario
				inner join 
					tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
				inner join 
					tc_keet_prototipos on tc_keet_proyectos_archivos.id_prototipo = tc_keet_prototipos.id_prototipo
				inner join 
					tc_keet_planos on tc_keet_proyectos_archivos.id_plano = tc_keet_planos.id_plano
				inner join 
					tc_keet_especialidades on tc_keet_planos.id_especialidad = tc_keet_especialidades.id_especialidad
				where
				  tc_keet_proyectos_archivos.id_proyecto= {idProyecto}
			</select>
		</unit>		
		<unit id="VistaProyectosGeneradoresDto">
			<select id="importados">
				select
					tc_keet_proyectos_generadores.id_proyecto_generador id_key,
					tc_keet_proyectos_generadores.nombre,
					tc_keet_proyectos_generadores.archivo,
					tc_keet_proyectos_generadores.ruta,
					tc_keet_proyectos_generadores.alias,
					tc_keet_proyectos_generadores.observaciones,
					tc_keet_proyectos_generadores.registro,
					concat(tc_mantic_personas.nombres,' ',tc_mantic_personas.paterno,' ',tc_mantic_personas.materno) usuario,
					tc_keet_proyectos_generadores.id_tipo_archivo,
					tc_keet_tipos_generadores.clave clave_generador,
					tc_keet_tipos_generadores.nombre nombre_generador,
					tc_keet_estaciones.nombre nombre_estacion
				from
					tc_keet_proyectos_generadores
				inner join 
					tc_janal_usuarios on tc_keet_proyectos_generadores.id_usuario = tc_janal_usuarios.id_usuario
				inner join 
					tc_mantic_personas on tc_janal_usuarios.id_persona= tc_mantic_personas.id_persona
				inner join 
					tc_keet_tipos_generadores on tc_keet_proyectos_generadores.id_tipo_generador = tc_keet_tipos_generadores.id_tipo_generador
				inner join 
					tc_keet_estaciones on tc_keet_tipos_generadores.id_estacion = tc_keet_estaciones.id_estacion
				where
				  tc_keet_proyectos_generadores.id_proyecto= {idProyecto}
			</select>
		</unit>		
		<unit id="VistaProyectosPresupuestosDto">
			<select id="importados">
				select
					tc_keet_proyectos_presupuestos.id_proyecto_presupuesto id_key,
					tc_keet_proyectos_presupuestos.nombre,
					tc_keet_proyectos_presupuestos.archivo,
					tc_keet_proyectos_presupuestos.ruta,
					tc_keet_proyectos_presupuestos.alias,
					tc_keet_proyectos_presupuestos.observaciones,
					tc_keet_proyectos_presupuestos.registro,
					concat(tc_mantic_personas.nombres,' ',tc_mantic_personas.paterno,' ',tc_mantic_personas.materno) usuario,
					tc_keet_proyectos_presupuestos.id_tipo_archivo,
					tc_keet_tipos_presupuestos.nombre tipo_presupuesto
				from
					tc_keet_proyectos_presupuestos
				inner join 
					tc_janal_usuarios on tc_keet_proyectos_presupuestos.id_usuarios = tc_janal_usuarios.id_usuario
				inner join 
					tc_mantic_personas on tc_janal_usuarios.id_persona = tc_mantic_personas.id_persona
				inner join
					tc_keet_tipos_presupuestos on tc_keet_proyectos_presupuestos.id_tipo_presupuesto = tc_keet_tipos_presupuestos.id_tipo_presupuesto
				where
				  tc_keet_proyectos_presupuestos.id_proyecto= {idProyecto}
			</select>
		</unit>		
		<unit id="VistaNombresDiasDto">
			<select id="dias">
				select      
          tc_keet_nombres_dias.id_nombre_dia as id_key,
					tc_keet_nombres_dias.*
        from      
          tc_keet_nombres_dias
				inner join 
					tc_keet_prototipos_dias on tc_keet_nombres_dias.id_nombre_dia = tc_keet_prototipos_dias.id_nombre_dia
        where 
          {condicion} 
			</select>
		</unit>
	</dml>    
</process>
